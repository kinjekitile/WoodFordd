@model AdvanceReportNotificationModel


@{
    string loyaltyColour = "#118254";

    if (Model.CurrentLevel.ToLower() == "silver") {
        loyaltyColour = "#BCBDBF";
    }

    if (Model.CurrentLevel.ToLower() == "gold") {
        loyaltyColour = "#DDBF21";
    }

}

<table style="width: 100%;max-width: 1000px;min-width: 820px;max-height: 450px;">
    <tbody>
        <tr>
            <td style="padding: 20px;">
                <img style="width: 100%;" src="@(Model.SiteDomain)Content/images/advancereport/header.png" />
            </td>
        </tr>
    </tbody>
</table>

<table style="width: 100%;border:none;border-collapse:collapse;max-width: 1000px;min-width: 820px;" cellspacing="0" cellpadding="0">
    <tbody>
        
        <tr style="background-color: #EDEDEF;">
            <td style="height: 40px;padding-left: 30px;padding-top: 30px;" colspan="5">
                <p>Dear @Model.User.FirstName</p>

                <p>Thank you for your continued support of Woodford Car Hire and Advance. Below you&#39;ll find your (monthly) Advance statement that details your level; rentals and; points available for spend.</p>

                <p>Please feel free to get in touch should you require any further information.</p>

                <p>Regards</p>

                <p>The Woodford Advance Team</p>

                <p><a href="mailto:advance@woodford.co.za">advance@woodford.co.za</a></p>

            </td>
        </tr>
        <tr style="background-color: #EDEDEF;">
            <td style="height: 40px;" colspan="5"></td>
        </tr>
        <tr style="background-color: #EDEDEF;height: 250px;">
            <td style="padding-left: 30px;padding-right: 0px; vertical-align:top;height: 250px;">
                <span style="color: #118254;font-size: 18px;margin-top: 0px;">
                    <strong><i>Account</i></strong>
                </span>
                <br />
                <span style="font-size: 12px;">
                    Current Level: <strong><i>@Model.CurrentLevel</i></strong>
                    <br />
                    Rentals to next level: <strong><i>@Model.BookingsToMoveUpTier</i></strong>
                </span>
            </td>
            <td style="border:none !important;padding-right:0px;width: 0px;height: 250px;">
                <img src="@(Model.SiteDomain)Content/images/advancereport/circle-@(Model.CurrentLevel.ToLower())-@(Model.BookingsToMoveUpTier).png" style="height: 108%;display:block;" />
            </td>
            <td style="background-color: white;padding-left: 10px;vertical-align: top;padding-top: 20px;min-width: 200px;height: 250px;padding-left: 20px;">
                Current Advance Level:<br />
                <span style="color: @(loyaltyColour);"><strong>@Model.CurrentLevel</strong></span>


                <p style="font-size: 12px;">
                    You have hired @Model.Overview.BookingPerLoyaltyPeriod times<br />
                    in the last quarter,<br />
                    You need to hire @Model.BookingsToMoveUpTier more times<br />
                    to @if (Model.CurrentLevel == "Gold") { <text>maintain your level.</text> } else { <text>move up a level.</text> }
                </p>


                Loyalty Period<br />
                <span style="font-size: 12px;">@Model.User.LoyaltyPeriodStart.Value.ToString("dd MMM yyyy") - @Model.User.LoyaltyPeriodEnd.Value.ToString("dd MMM yyyy")</span>
            </td>
            <td style="background-color: white;height: 250px;">
                <img src="@(Model.SiteDomain)Content/images/advancereport/arrow-@(Model.CurrentLevel.ToLower()).png" style="height: 250px;" />
            </td>
            <td style="background-color: white;vertical-align: top;padding-top: 20px;height: 250px;padding-left: 20px;">
                <strong style="color: @(loyaltyColour); font-size: 35px;">@Model.CurrentLevel</strong>
                <br />
                <br />
                @if (Model.CurrentLevel == "Gold") {
                    <strong style="font-size: 14px;">

                        @Model.BookingsRequiredForCurrentLoyaltyTier + rentals per quarter

                    </strong>
                }
                else {
                    <strong style="font-size: 14px;">

                        @Model.BookingsRequiredForCurrentLoyaltyTier to @(Model.BookingsRequiredForNextLoyaltyTier - 1) rentals per quarter

                    </strong>
                }
                
                <br />
                <p style="font-size: 12px;">
                    Earns you <strong>@(decimal.Round(Model.LoyaltyTierPointsPercentage * 100, 2))%</strong> of the total
                    <br />
                    value of your rental*
                </p>
            </td>
        </tr>
        <tr style="background-color: #EDEDEF;">
            <td style="height: 40px;" colspan="5"></td>
        </tr>
        <tr style="background-color: #EDEDEF;">
            <td style="height: 250px;padding-left: 30px;padding-right: 0px;">
                <span style="color: #118254;font-size: 18px;margin-top: 0px;">
                    <strong><i>Rental History</i></strong>
                </span>
            </td>
            <td style="height: 250px;padding-left: 40px;padding-right:20px;" colspan="4">
                <table border="1" style="background-color: white;width:100%;padding-right: 20px;border-collapse: collapse;border-color: #AEAEB0;" cellpadding="7">
                    <thead>
                        <tr>
                            <th style="text-align:left;border-color: #D0D0D2;"></th>
                            <th style="text-align: left;border-color: #D0D0D2;">Collection</th>
                            <th style="text-align: left;border-color: #D0D0D2;">Returned</th>
                            <th style="text-align: left;border-color: #D0D0D2;">Collected At</th>
                            <th style="text-align: left;border-color: #D0D0D2;">Returned To</th>
                            <th style="text-align: left;border-color: #D0D0D2;">Points</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.Overview.HistoryItemsForPeriod.Count() > 0) {
                            foreach (var item in Model.Overview.HistoryItemsForPeriod) {
                        <tr>
                            <td style="border-color: #D0D0D2;">
                                <a href="@(Model.SiteDomain)reservations/past">Details</a>
                            </td>
                            <td style="border-color: #D0D0D2;">
                                @item.PickupDate.ToString("dd MMM yyyy")
                            </td>

                            <td style="border-color: #D0D0D2;">
                                @item.DropOffDate.ToString("dd MMM yyyy")
                            </td>
                            <td style="border-color: #D0D0D2;">
                                @item.PickupBranch.Title
                            </td>
                            <td style="border-color: #D0D0D2;">
                                @item.DropoffBranch.Title
                            </td>
                            <td style="text-align:center;border-color: #D0D0D2;">
                                @if (item.LoyaltyPointsEarned.HasValue) {
                                        <text>@decimal.Round(item.LoyaltyPointsEarned.Value, 0)</text>
                                        }

                            </td>
                        </tr>
                            }

                        }
                        else {
                        <tr>
                            <td colspan="6">No bookings for current loyalty period.</td>
                        </tr>
                        }


                    </tbody>
                </table>
            </td>
        </tr>
        <tr style="background-color: #EDEDEF;">
            <td style="height: 250px;padding-left: 40px;padding-right:20px;padding-bottom:30px;" colspan="5">

                <table style="background-color: white;width:100%;padding-right: 20px;border:none;border-collapse:collapse;" cellpadding="7">
                    <tr>
                        @foreach (var item in Model.NewsAndCampaigns) {
                            <td align="center" valign="middle" style="text-align: center;max-height: 250px;" width="33%">
                                <a href="@(Model.SiteDomain)@(item.UrlPart)" style="text-decoration: none;">
                                    @if (item.UseWidth) {
                                        <img src="@(Model.SiteDomain)@(item.ImageUrlPart)?filename=news&width=280" />
                                    }
                                    else {
                                        <img src="@(Model.SiteDomain)@(item.ImageUrlPart)?filename=news&height=180" />
                                    }
                                    
                                    <br /><br />
                                    <span style="color: black;">@item.Title</span>
                                </a>
                            </td>
                        }
                    </tr>

                    </table>
</td>
        </tr>
    </tbody>
</table>

